<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>波动率计算测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: inline-block;
            width: 120px;
            font-weight: bold;
        }
        .input-group input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100px;
        }
        .result {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .star {
            color: #ff9800;
            font-size: 20px;
        }
        .examples {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .example-item {
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 3px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <h1>波动率计算测试工具</h1>
    
    <div class="test-section">
        <h2>波动率计算器</h2>
        <div class="input-group">
            <label>阈值设置:</label>
            <input type="number" id="threshold" value="0.1" step="0.1" min="0.1" max="5">
            <span>%</span>
        </div>
        <div class="input-group">
            <label>实际波动率:</label>
            <input type="number" id="volatility" value="0.15" step="0.01" min="0">
            <span>%</span>
        </div>
        <button onclick="calculateStar()">计算星级</button>
        
        <div id="result" class="result" style="display: none;">
            <h3>计算结果:</h3>
            <div id="resultContent"></div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>星级触发示例</h2>
        <div class="examples">
            <h3>设置阈值 0.1% 时:</h3>
            <div class="example-item">波动率 0.1% → 倍数 1.0 → <span class="star">★</span> 1星</div>
            <div class="example-item">波动率 0.2% → 倍数 2.0 → <span class="star">★★</span> 2星</div>
            <div class="example-item">波动率 0.3% → 倍数 3.0 → <span class="star">★★★</span> 3星</div>
            <div class="example-item">波动率 0.4% → 倍数 4.0 → <span class="star">★★★★</span> 4星</div>
            <div class="example-item">波动率 0.5% → 倍数 5.0 → <span class="star">★★★★★</span> 5星</div>
            <div class="example-item">波动率 0.6% → 倍数 6.0 → <span class="star">★★★★★</span> 5星 (最多5星)</div>
        </div>
        
        <div class="examples">
            <h3>设置阈值 0.5% 时:</h3>
            <div class="example-item">波动率 0.5% → 倍数 1.0 → <span class="star">★</span> 1星</div>
            <div class="example-item">波动率 1.0% → 倍数 2.0 → <span class="star">★★</span> 2星</div>
            <div class="example-item">波动率 1.5% → 倍数 3.0 → <span class="star">★★★</span> 3星</div>
            <div class="example-item">波动率 2.0% → 倍数 4.0 → <span class="star">★★★★</span> 4星</div>
            <div class="example-item">波动率 2.5% → 倍数 5.0 → <span class="star">★★★★★</span> 5星</div>
        </div>
        
        <div class="examples">
            <h3>设置阈值 1.0% 时:</h3>
            <div class="example-item">波动率 1.0% → 倍数 1.0 → <span class="star">★</span> 1星</div>
            <div class="example-item">波动率 2.0% → 倍数 2.0 → <span class="star">★★</span> 2星</div>
            <div class="example-item">波动率 3.0% → 倍数 3.0 → <span class="star">★★★</span> 3星</div>
            <div class="example-item">波动率 4.0% → 倍数 4.0 → <span class="star">★★★★</span> 4星</div>
            <div class="example-item">波动率 5.0% → 倍数 5.0 → <span class="star">★★★★★</span> 5星</div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>计算公式说明</h2>
        <div class="examples">
            <h3>波动率计算:</h3>
            <div class="example-item">波动率 = (标准差 / 平均价格) × 100%</div>
            
            <h3>星级计算:</h3>
            <div class="example-item">倍数 = 实际波动率 / 设定阈值</div>
            <div class="example-item">星级 = Math.floor(倍数) (向下取整，最多5星)</div>
            
            <h3>示例计算:</h3>
            <div class="example-item">阈值: 0.1%, 波动率: 0.25%</div>
            <div class="example-item">倍数: 0.25 / 0.1 = 2.5</div>
            <div class="example-item">星级: Math.floor(2.5) = 2星</div>
        </div>
    </div>

    <script>
        function calculateStar() {
            const threshold = parseFloat(document.getElementById('threshold').value);
            const volatility = parseFloat(document.getElementById('volatility').value);
            
            if (isNaN(threshold) || isNaN(volatility)) {
                alert('请输入有效的数值');
                return;
            }
            
            if (volatility < threshold) {
                document.getElementById('result').style.display = 'block';
                document.getElementById('resultContent').innerHTML = `
                    <p><strong>波动率 ${volatility}% 未达到阈值 ${threshold}%</strong></p>
                    <p>不会触发通知</p>
                `;
                return;
            }
            
            const multiplier = volatility / threshold;
            const level = Math.min(Math.floor(multiplier), 5);
            
            const stars = '★'.repeat(level);
            
            document.getElementById('result').style.display = 'block';
            document.getElementById('resultContent').innerHTML = `
                <p><strong>计算结果:</strong></p>
                <p>阈值: ${threshold}%</p>
                <p>实际波动率: ${volatility}%</p>
                <p>倍数: ${multiplier.toFixed(2)}</p>
                <p>星级: <span class="star">${stars}</span> ${level}星</p>
                <p><strong>通知消息:</strong></p>
                <p style="background: #fff3cd; padding: 10px; border-radius: 4px;">
                    波动率达到 ${volatility.toFixed(2)}% (阈值${threshold}%的${multiplier.toFixed(1)}倍)，触发 ${level} 星通知
                </p>
            `;
        }
        
        // 页面加载时自动计算一次
        window.onload = function() {
            calculateStar();
        };
    </script>
</body>
</html> 